<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI予測</title>
    <!-- Tailwind CSS をCDNから読み込む -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* スピナーのスタイル */
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 font-sans flex flex-col items-center justify-center min-h-screen">

    <h2 class="text-2xl font-semibold mb-6">AI 予測システム</h2>

    <!-- 入力フォーム -->
    <div class="space-y-4 mb-6">
        <div>
            <label for="oddsA" class="text-lg">oddsA:</label>
            <input type="number" id="oddsA" step="0.01" class="px-4 py-2 border rounded-lg shadow-md w-48" />
        </div>
        <div>
            <label for="oddsB" class="text-lg">oddsB:</label>
            <input type="number" id="oddsB" step="0.01" class="px-4 py-2 border rounded-lg shadow-md w-48" />
        </div>
        <button onclick="predict()" class="bg-blue-500 text-white px-6 py-2 rounded-full shadow-md hover:bg-blue-600">
            AI学習
        </button>
    </div>

    <!-- ローディングスピナー -->
    <div id="loading" class="hidden">
        <div class="spinner mb-4"></div>
        <p class="text-lg">予測中...お待ちください</p>
    </div>

    <!-- 予測結果 -->
    <div id="result-container" class="hidden">
        <h3 class="text-xl font-semibold mt-6">予測結果:</h3>
        <p id="result" class="text-lg mt-2"></p>
    </div>

    <script>
        async function predict() {
            const oddsA = document.getElementById("oddsA").value;
            const oddsB = document.getElementById("oddsB").value;
            
            if (!oddsA || !oddsB) {
                alert("oddsA と oddsB を入力してください");
                return;
            }

            // ローディングスピナーを表示
            document.getElementById("loading").classList.remove("hidden");
            document.getElementById("result-container").classList.add("hidden");

            try {
                const response = await fetch("http://localhost:8000/predict/", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ oddsA: parseFloat(oddsA), oddsB: parseFloat(oddsB) })
                });

                const data = await response.json();

                // 結果を表示
                document.getElementById("result").innerText = 
                    `Random Forest 予測: ${data.rf_prediction}\n` + 
                    `XGBoost 予測: ${data.xgb_prediction}\n` + 
                    `PyTorch 予測: ${data.torch_prediction}`;
                
                // ローディングスピナーを隠し、結果を表示
                document.getElementById("loading").classList.add("hidden");
                document.getElementById("result-container").classList.remove("hidden");
            } catch (error) {
                alert("予測の取得に失敗しました。再試行してください。");
                document.getElementById("loading").classList.add("hidden");
            }
        }
    </script>

</body>
</html>
